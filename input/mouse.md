# 鼠标事件

鼠标指针即鼠标操作事件。在 RFB 协议中，使用 PointerEvent 表示客户端触发一次鼠标事件。

> TODO: 鼠标事件 = 鼠标移动 + 鼠标点击

## 协议报文

鼠标事件的报文如下

```
  +--------------+--------------+--------------+
  | No. of bytes | Type [Value] | Description  |
  +--------------+--------------+--------------+
  | 1            | U8 [5]       | message-type |
  | 1            | U8           | button-mask  |
  | 2            | U16          | x-position   |
  | 2            | U16          | y-position   |
  +--------------+--------------+--------------+
```

- message-type: 无符号整形，固定 0x5
- button-mask: 8位掩码，表示键位状态，1为按下，0为弹起
- x-position: 当前 X 坐标
- y-position: 当前 Y 坐标

button-mask 的 Bit0/1/2 位置分别代表鼠标的左键、中建、右键。使用滚轮的鼠标，每向上滑动一次，会发送一个 Bit3 的按下和弹起事件；每向下滑动一次，会发送一个 Bit4 的按下和弹起事件。

## USB/PS/2 鼠标协议

在 PS/2 或 USB 鼠标协议中，有类似 RFB 协议的表达方式。

![鼠标协议](http://babeler-1251731700.cos.ap-shanghai.myqcloud.com/2021-08-09-104852.jpg)

鼠标协议和 RFB 协议有两点不同：

- 鼠标协议的 Bit0/1/2 和 RFB 协议的 Bit0/2/1 对应
- 鼠标协议的中轮转动，需要转换为 RFB 协议的按下/弹起事件

> 特殊按键（例如游戏鼠标）会被模拟映射到不同的键盘信号(或组合)